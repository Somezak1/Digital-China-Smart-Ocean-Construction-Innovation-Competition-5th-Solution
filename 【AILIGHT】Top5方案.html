<html>
<head>
  <title>【AILIGHT】Top5方案</title>
  <basefont face="微软雅黑 Light" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605766 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑 Light;
      font-size: 14pt;
    }
  </style>
</head>
<body>
<a name="11719"/>
<h1>【AILIGHT】Top5方案</h1>

<div><span>
  <div style="--en-clipped-content:article; --en-clipped-source-url:https://mp.weixin.qq.com/s/TvO2EPGJu04JvhX67uQsHw; --en-clipped-source-title:【时序多分类赛题】2020数字中国创新大赛-智慧海洋建设top5方案（含源码）;">
<div><br/></div><div style="min-height: 8535px; font-size: 16px; display:block; min-width: 100%; position: relative;"> <div style="line-height:1.6;text-size-adjust:100%;"><div style="letter-spacing:0.034em;color:rgba(255, 255, 255, 0.6);background-color:rgb(17, 17, 17);line-height:1.6;font-family:-apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;"><div><div style="overflow-wrap:break-word;hyphens:auto;"><div style="background-color:rgb(25, 25, 25);">

		  <div style="margin:0px;padding:0px;margin-left:auto;margin-right:auto;max-width:677px;">

            
                        
                        

            <div style="margin:0px;padding:0px;position:relative;zoom:1;">
                
                <h2 style="margin:0px;padding:0px;line-height:1.4;margin-bottom:14px;font-size:22px;font-weight:700;">
                    
                    
                    
【时序多分类赛题】2020数字中国创新大赛-智慧海洋建设top5方案（含源码）
                </h2>
                <div style="margin:0px;padding:0px;margin-bottom:22px;line-height:20px;font-size:0px;overflow-wrap:break-word;hyphens:auto;position:relative;z-index:1;">
                                                                <span style="-webkit-tap-highlight-color:rgba(0, 0, 0, 0);margin:0px 10px 10px 0px;line-height:1.67;border-radius:2px;width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-wrap:normal;max-width:70%;font-style:normal;letter-spacing:normal;background:rgba(0, 0, 0, 0.05);display:inline-block;vertical-align:middle;font-size:12px;background-color:rgba(255, 255, 255, 0.05);padding:0px 4px;color:rgba(255, 255, 255, 0.3);margin-right:8px;">原创</span>
                                                                                            <span style="padding:0px;display:inline-block;vertical-align:middle;font-size:15px;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);margin:0px 10px 10px 0px;color:rgba(255, 255, 255, 0.3);">
                                                                    AILIGHT
                                                            </span>
                                                                
                                        <span style="padding:0px;display:inline-block;vertical-align:middle;font-size:15px;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);position:relative;margin:0px 10px 10px 0px;">
                      <a href="#" style="margin:0px;padding:0px;color:rgb(125, 144, 169);text-decoration:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;">
                        AILIGHT                      </a>
                      
                    </span>
                    <em style="padding:0px;font-style:normal;display:inline-block;vertical-align:middle;font-size:15px;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);margin:0px 10px 10px 0px;color:rgba(255, 255, 255, 0.3);">2020-05-18</em>
                </div>

                
                                                

                
                                
                
                

                
                                                                

                
                                


                
                
                
                
                                                
                                                                
                                
                                
                
                <div style="margin:0px;padding:0px;overflow:hidden;font-size:17px;overflow-wrap:break-word;hyphens:auto;text-align:justify;z-index:0;color:rgba(255, 255, 255, 0.6);position:relative;visibility:visible;">
                    

                    
                    
                    
                    <div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);font-size:16px;padding-right:10px;padding-left:10px;line-height:1.6;letter-spacing:0px;word-break:break-word;text-align:left;font-family:Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;margin-top:-10px;visibility:visible;"><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;visibility:visible;"><img src="【AILIGHT】Top5方案_files/640" type="image/png" data-filename="640" height="149" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;visibility:visible !important;width:553px !important;" width="553"/><img src="【AILIGHT】Top5方案_files/640 [1]" type="image/png" data-filename="640" height="149" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;visibility:visible !important;width:553px !important;" width="553"/>    Hi，大家好！这里是AILIGHT！AI light the world！这次给大家带来的是2020数字中国创新大赛-数字政府赛道-智能算法赛：智慧海洋建设的算法赛复赛赛道B top5的方案以及代码开源。比赛传送门：https://tianchi.aliyun.com/competition/entrance/231768/introduction
这是我们队伍参加的为数不多的数据挖掘类的算法竞赛。经过两个多月的时间，我们队伍最终在算法赛道B阶段取得top5的成绩。说一下参赛体验：都是神仙打架，太难了！接下来进入正题吧！</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;visibility:visible;">    本方案采用<code style="margin:0px;padding:2px 4px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;background-color:rgba(49, 56, 63, 0.05);font-size:14px;border-radius:4px;margin-right:2px;margin-left:2px;color:rgb(30, 107, 184);font-family:&quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;word-break:break-all;visibility:visible;">特征工程 ＋ NLP的相关技术</code>，下面为大家进行详细介绍。</p><h2 style="font-weight:bold;font-size:22px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;visibility:visible;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;visibility:visible;"><center style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;visibility:visible;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(0, 104, 255);visibility:visible;">任务介绍</span></center></span><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;visibility:visible;"></span></h2><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;visibility:visible;">    赛题基于位置数据对海上目标进行智能识别和作业行为分析，要求选手通过分析渔船北斗设备位置数据，得出该船的生产作业行为，具体判断出是拖网作业、围网作业还是流刺网作业。数据包含脱敏后的渔船ID、经纬度坐标、上报时间、速度、航向信息，由于真实场景下海上环境复杂，经常出现信号丢失，设备故障等原因导致的上报坐标错误、上报数据丢失、甚至有些设备疯狂上报等。每一个渔船ID对应多条上报数据。数据示例如图:<img src="【AILIGHT】Top5方案_files/640 [2]" type="image/png" data-filename="640" height="105" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:677px !important;visibility:visible !important;" width="657"/>    分析完整个赛题其实是一个时序多分类的任务。</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    评价标准：以3种类别的各自F1值取平均做为评价指标</p><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [3]" type="image/png" data-filename="640" height="119" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:264px !important;visibility:visible !important;" width="264"/></div><h2 style="font-weight:bold;font-size:22px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><center style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(0, 104, 255);">数据分析&amp;特征分析</span></center></span><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"></span></h2><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    主要从以下4个方面去进行了数据分析和特征的分析</p><h3 style="font-weight:bold;font-size:20px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;">2-1. 基本信息</span></h3><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [4]" type="image/png" data-filename="640" height="534" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:540px !important;visibility:visible !important;" width="540"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">经纬度/x-y的分布</div></div><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;margin-top:8px;margin-bottom:8px;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">不同渔船的作业方式的区域有很大的区分度；</div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">区域的重叠部分容易混淆，需要更多的信息进行判断；</div></li></ul><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [5]" type="image/png" data-filename="640" height="175" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:552px !important;visibility:visible !important;" width="552"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">速度/speed的分布</div></div><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;margin-top:8px;margin-bottom:8px;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">gill netter(刺网)作业方式大部分都在速度0或接近0的情况下作业；</div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">速度的稳定性 trawler(拖网) &gt; seiner(围网) &gt; gill netter(刺网)；</div></li></ul><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [6]" type="image/png" data-filename="640" height="208" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:677px !important;visibility:visible !important;" width="657"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">方向/direction的分布</div></div><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;margin-top:8px;margin-bottom:8px;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">三种作业方式的方向/direction在方向特别小的情况有一定差异；</div></li></ul><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">我们对基础特征进行max，min...等进行统计得到一些基础特征</p><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">7</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">8</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">9</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">10</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">11</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">def group_feature(df, key, target, aggs,flag):   </span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">  agg_dict = {}</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">  for ag in aggs:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">      agg_dict['{}_{}_{}'.format(target,ag,flag)] = ag</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">  print(agg_dict)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">  t = df.groupby(key)[target].agg(agg_dict).reset_index()</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">  return t</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">t = group_feature(df, 'ship','x',['max','min','mean','median','std','skew'],flag)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">t = group_feature(df, 'ship','speed',['max','mean','median','std','skew'],flag)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">t = group_feature(df, 'ship','direction',['max','median','mean','std','skew'],flag)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">t = group_feature(df, 'ship','y',['max','min','mean','median','std','skew'],flag)</span></code></pre></div><h3 style="font-weight:bold;font-size:20px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;">2-2. 细致信息</span></h3><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [7]" type="image/png" data-filename="640" height="446" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:677px !important;visibility:visible !important;" width="657"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">speed &gt; 0 &amp; speed == 0  经纬度/x-y 分布</div></div><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [8]" type="image/png" data-filename="640" height="450" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:677px !important;visibility:visible !important;" width="657"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">Day&amp;Night 经纬度/x-y 分布</div></div><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;margin-top:8px;margin-bottom:8px;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">同一种作业方式在不同速度的位置区域(经纬度)也有着一定的差异</div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">同一种作业方式在Day&amp;Night上速度上有着一定的差异</div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">同一种作业方式在Day&amp;Night上位置区域(经纬度)有着一定的差异</div></li></ul><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">7</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">8</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">9</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">10</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_1 = data[data['speed']==0]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_2 = data[data['speed']!=0]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_label = extract_feature(data_1, data_label,&quot;0&quot;)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_label = extract_feature(data_2, data_label,&quot;1&quot;)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">df['day_nig'] = 0</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">df.loc[(df['hour'] &gt; 5) &amp; (df['hour'] &lt; 20),'day_nig'] = 1</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_1 = data[data['day_nig'] == 0]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_2 = data[data['day_nig'] == 1]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_label = extract_feature(data_1, data_label,&quot;on_night&quot;)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">data_label = extract_feature(data_2, data_label,&quot;on_day&quot;)</span></code></pre></div><h2 style="font-weight:bold;font-size:22px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;">2-3. 动态信息</span><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"></span></h2><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    每个渔船id的速度、经纬度看做是一个序列信息</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    利用速度、经纬度的分位数统计量，将浮点特征分桶转成一个类型特征</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    使用不同的ngram提取TF-IDF 特征（ngram=1, 2, 3）</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    对不同ngram提取的特征t-SNE 降维到二维，进行可视化</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    最终，利用NLP的TF-IDF提取关键高维的ngram信息，有效获取速度和经纬度动态变化的信息</p><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">#分桶</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">def cut_bins(raw_data, col_name=None, q=49):</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    features, bins = pd.qcut(raw_data[col_name], q=q, retbins=True, duplicates=&quot;drop&quot;)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    labels = list(range(len(bins) - 1))</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    features, bins = pd.qcut(raw_data[col_name], labels=labels, q=q, retbins=True, duplicates=&quot;drop&quot;)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    return features, bins, labels</span></code></pre></div><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [9]" type="image/png" data-filename="640" height="201" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:677px !important;visibility:visible !important;" width="657"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">经纬度/x-y ngram=1, ngram=2, ngram=3降维之后结果(从左到右)</div></div><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">7</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">8</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">9</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">10</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">11</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;"># 讲融合后的taglist当作一句话进行文本处理</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">self.data['title_feature'] = self.data[self.to_list].apply(lambda x: x.split('|'))</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">self.data['title_feature'] = self.data['title_feature'].apply(lambda line: [w for w in line if w not in stop_words])</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">self.data['title_feature'] = self.data['title_feature'].apply(lambda x: ' '.join(x))</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><br style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"/></span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">print('start NMF')</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;"># 使用tfidf对元素进行处理</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">tfidf_vectorizer = TfidfVectorizer(ngram_range=(tf_n,tf_n))</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">tfidf = tfidf_vectorizer.fit_transform(self.data['title_feature'].values)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">#使用nmf算法，提取文本的主题分布</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">text_nmf = NMF(n_components=self.nmf_n).fit_transform(tfidf)</span></code></pre></div><h2 style="font-weight:bold;font-size:22px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;">2-4. 基于word2vec的表征</span><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"></span></h2><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    使用深度学习的word2vec的CBOW算法无监督训练，获取经纬度(x-y)和速度(speed)的类型向量</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    每个渔船id的经纬度和速度向量取平均作为特征，然后使用t-SNE 降维到二维，进行可视化</p><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">    最终，利用NLP的word2vec提取区域的交互动态信息，有效获取速度和经纬度信息</p><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [10]" type="image/png" data-filename="640" height="291" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:677px !important;visibility:visible !important;" width="657"/><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:5px;text-align:center;color:#888;font-size:14px;">word2vec 降维之后可视化（从左到右）·经纬度· ·经纬度+速度·</div></div><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">7</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">8</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">9</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">10</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">11</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">12</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">13</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">14</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">15</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">16</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">17</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">18</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">19</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">20</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">21</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">22</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">23</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">24</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">25</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">26</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">from gensim.models import Word2Vec</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    import gc</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    def emb(df, f1, f2):</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        emb_size = 23</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        print('====================================== {} {} ======================================'.format(f1, f2))</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        tmp = df.groupby(f1, as_index=False)[f2].agg({'{}_{}_list'.format(f1, f2): list})</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        sentences = tmp['{}_{}_list'.format(f1, f2)].values.tolist()</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        del tmp['{}_{}_list'.format(f1, f2)]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        for i in range(len(sentences)):</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">            sentences[i] = [str(x) for x in sentences[i]]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        model = Word2Vec(sentences, size=emb_size, window=5, min_count=3, sg=0, hs=1, seed=2222)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        emb_matrix = []</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        for seq in sentences:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">            vec = []</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">            for w in seq:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">                if w in model:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">                    vec.append(model[w])</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">            if len(vec) &gt; 0:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">                emb_matrix.append(np.mean(vec, axis=0))</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">            else:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">                emb_matrix.append([0] * emb_size)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        emb_matrix = np.array(emb_matrix)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        for i in range(emb_size):</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">            tmp['{}_{}_emb_{}'.format(f1, f2, i)] = emb_matrix[:, i]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        del model, emb_matrix, sentences</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        return tmp</span></code></pre></div><h2 style="font-weight:bold;font-size:22px;margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:30px;margin-bottom:15px;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><center style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(0, 104, 255);">最终模型</span></center></span><span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"></span></h2><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;margin-top:8px;margin-bottom:8px;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;"><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);padding-top:8px;padding-bottom:8px;line-height:26px;">训练模型前采用Lightgbm进行初步的特征筛选</p></div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;"><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);padding-top:8px;padding-bottom:8px;line-height:26px;">最后用我们非常熟悉的Lightgbm进行模型训练，单模型5折最终线上F1=0.8990</p></div></li></ul><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">7</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">8</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">9</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">10</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">from feature_selector import FeatureSelector</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">fs = FeatureSelector(data = train_label[features], labels = train_label[target])</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">fs.identify_zero_importance(task = 'classification', eval_metric = 'multiclass',</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">                            n_iterations = 10, early_stopping = True)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">fs.identify_low_importance(cumulative_importance = 0.97)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">low_importance_features = fs.ops['low_importance']</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">print('====low_importance_features=====')</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">print(low_importance_features)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">for i in low_importance_features:</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    features.remove(i)</span></code></pre></div><div style="padding:0px;font-size:14px;position:relative;background-color:rgba(0, 0, 0, 0.03);border:1px solid rgb(240, 240, 240);border-radius:2px;display:flex;line-height:26px;margin:10px 0px;color:rgba(255, 255, 255, 0.8);box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><ul style="margin:0px;flex-shrink:0;height:100%;list-style-type:none;padding:1em;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">1</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">2</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">3</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">4</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">5</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">6</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">7</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">8</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">9</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">10</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">11</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">12</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">13</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">14</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">15</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">16</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">17</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">18</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">19</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">20</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">21</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">22</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">23</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">24</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">25</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">26</span></li><li style="margin:0px;padding:0px;list-style-type:none;text-align:right;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><span style="list-style-type:none;text-align:right;min-width:1.5em;left:-2.5em;display:inline;color:rgba(255, 255, 255, 0.3);">27</span></li></ul><pre style="margin:0px;overflow-x:auto;white-space:normal;-webkit-box-flex:1;flex:1 1 0%;padding:1em 1em 1em 0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;"><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">def macro_f1(y_hat, data):</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    y_true = data.get_label()</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    y_hat = y_hat.reshape(-1, y_true.shape[0])</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    y_hat = np.argmax(y_hat, axis=0)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    f1_multi = precision_recall_fscore_support(y_true, y_hat, labels=[0, 1, 2])[2]</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    f1_macro =  f1_score(y_true, y_hat, average =&quot;macro&quot;)</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    assert np.mean(f1_multi) ==  f1_macro</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    return 'f1', f1_macro, True</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">params = {</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'task':'train', </span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'num_leaves': 63,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'objective': 'multiclass',</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'num_class': 3,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'metric': 'None', # [f1_0, f1_1, f1_2],</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'min_data_in_leaf': 10,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'learning_rate': 0.01,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'feature_fraction': 0.7,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'bagging_fraction': 0.95,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'early_stopping_rounds': 2000,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">#         'lambda_l1': 0.1,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">#         'lambda_l2': 0.1,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        &quot;first_metric_only&quot;: True,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'bagging_freq': 3, </span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'max_bin': 255,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'random_state': 42,</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">        'verbose' : -1</span></code><code style="margin:0px;padding:0px;text-align:left;font-size:14px;position:relative;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;white-space:pre;display:flex;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;border-radius:0px;"><span style="margin:0px;padding:0px;box-sizing:border-box;overflow-wrap:break-word;max-width:1000%;line-height:26px;">    }</span></code></pre></div><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;margin-top:8px;margin-bottom:8px;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">To do:</div></li><ul style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-left:25px;color:rgb(163, 163, 163);margin-top:8px;margin-bottom:8px;list-style-type:square;"><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">将渔船每条航行的时序数据当做一个句子/段落/文档进行处理</div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">提取更深含义的渔船航线特征,学习到更高层次的渔船航线规律</div></li><li style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);margin-top:5px;margin-bottom:5px;line-height:26px;">多模型加权融合or stacking（lgb，xgb，...）</div></li></ul></ul><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;padding-top:8px;padding-bottom:8px;line-height:26px;">关注并回复“<span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(255, 23, 0);">AILIGHT智慧海洋建设<span style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;color:rgb(163, 163, 163);">”获取源码链接以及完整的特征分析可视化方案，还没有关注的朋友，扫描下方二维码识别关注吧。有什么建议也可以后台留言哦！</span></span></p><div style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;margin-top:10px;margin-bottom:10px;"><img src="【AILIGHT】Top5方案_files/640 [11]" type="image/png" data-filename="640" height="267" style="margin:0px;padding:0px;filter:brightness(0.8);max-width:100%;box-sizing:border-box;overflow-wrap:break-word;height:auto;display:block;margin-right:auto;margin-left:auto;width:267px !important;visibility:visible !important;" width="267"/></div></div><p style="margin:0px;padding:0px;clear:both;min-height:1em;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"><br style="margin:0px;padding:0px;max-width:100%;box-sizing:border-box;overflow-wrap:break-word;"/></p>
                </div>

                

                



                
                

                 
                                                    
                              
            </div>
                                        
                        
            

            
            
            

            

            


<div style="margin:0px;padding:0px;overflow:hidden;line-height:32px;font-size:15px;zoom:1;margin-top:15px;">
  <div style="margin:0px;padding:0px;display:flex;">
    <div style="margin:0px;padding:0px;-webkit-box-flex:1;flex:1 1 0%;display:flex;flex-wrap:wrap;min-width:0px;">
      
      
      
            
      

            
              

          </div>
  </div> 
   
</div>
  
  
  









                      </div>
        </div></div></div></div></div></div>
</div>
</span>
</div></body></html> 